-- 역순으로 삭제
DROP TABLE LECTURE_TBL;
DROP TABLE ENROLL_TBL;
DROP TABLE STUDENT_TBL;
DROP TABLE COURSE_TBL;
DROP TABLE PROFESSOR_TBL;

-- 교수 테이블 생성
CREATE TABLE PROFESSOR_TBL (
    PRO_NO         VARCHAR2(5 BYTE)   NOT NULL
   ,PRO_NAME       VARCHAR2(10 BYTE)  NULL
   ,PRO_MAJOR      VARCHAR2(100 BYTE) NULL
   ,CONSTRAINT PK_PRO_NO PRIMARY KEY(PRO_NO)
);

-- 과목 테이블 생성
CREATE TABLE COURSE_TBL (
    COU_NO        VARCHAR2(5 BYTE)  NOT NULL
   ,COU_NAME      VARCHAR2(30 BYTE) NULL
   ,COU_UNIT      VARCHAR2(10 BYTE) NULL
   ,CONSTRAINT PK_COU_NO PRIMARY KEY(COU_NO)
);

-- 학생 테이블 생성
CREATE TABLE STUDENT_TBL (
    STU_NO           VARCHAR2(10 BYTE)  NOT NULL
   ,STU_NAME         VARCHAR2(10 BYTE)  NULL
   ,STU_ADDRESS      VARCHAR2(100 BYTE) NULL
   ,STU_GRADE        NUMBER             NULL
   ,PRO_NO           VARCHAR2(5 BYTE)   NOT NULL
   ,CONSTRAINT PK_STU        PRIMARY KEY(STU_NO)
   ,CONSTRAINT FK_PRO_NO_STU FOREIGN KEY(PRO_NO) REFERENCES PROFESSOR_TBL(PRO_NO) ON DELETE CASCADE
);


-- 수강신청 테이블 생성
CREATE TABLE ENROLL_TBL (
    EN_NO     VARCHAR2(5 BYTE)  NOT NULL
   ,STU_NO    VARCHAR2(10 BYTE) NOT NULL
   ,COU_NO    VARCHAR2(5 BYTE)  NOT NULL
   ,EN_DATE   DATE              NULL
   ,CONSTRAINT PK_EN_NO     PRIMARY KEY(EN_NO)
   ,CONSTRAINT FK_STU_NO_EN FOREIGN KEY(STU_NO) REFERENCES STUDENT_TBL(STU_NO) ON DELETE CASCADE
   ,CONSTRAINT FK_COU_NO_EN FOREIGN KEY(COU_NO) REFERENCES COURSE_TBL(COU_NO) ON DELETE CASCADE
);

-- 강의 테이블 생성
CREATE TABLE LECTURE_TBL (
    LEC_NO    VARCHAR2(5 BYTE)  NOT NULL
   ,PRO_NO    VARCHAR2(5 BYTE)  NULL
   ,EN_NO     VARCHAR2(5 BYTE)  NULL
   ,LEC_NAME  VARCHAR2(50 BYTE) NULL
   ,CLASSROOM VARCHAR2(50 BYTE) NULL
   ,CONSTRAINT PK_LEC_NO     PRIMARY KEY(LEC_NO)
   ,CONSTRAINT FK_PRO_NO_LEC FOREIGN KEY(PRO_NO) REFERENCES PROFESSOR_TBL(PRO_NO) ON DELETE SET NULL
   ,CONSTRAINT FK_EN_NO_LEC  FOREIGN KEY(EN_NO) REFERENCES ENROLL_TBL(EN_NO) ON DELETE SET NULL
);
   
--교수번호,학번 시퀀스X
--강의번호,수강신청번호 시퀀스O


--교수
INSERT INTO PROFESSOR_TBL(PRO_NO, PRO_NAME, PRO_MAJOR) VALUES(10, 'ㄱ', '수학');
INSERT INTO PROFESSOR_TBL(PRO_NO, PRO_NAME, PRO_MAJOR) VALUES(20, 'ㄴ', '영어');
INSERT INTO PROFESSOR_TBL(PRO_NO, PRO_NAME, PRO_MAJOR) VALUES(30, 'ㄷ', '국어');


--과목
INSERT INTO COURSE_TBL(COU_NO, COU_NAME, COU_UNIT) VALUES(5555, 'GOOD', 123);
INSERT INTO COURSE_TBL(COU_NO, COU_NAME, COU_UNIT) VALUES(6666, 'JOB', 456);
INSERT INTO COURSE_TBL(COU_NO, COU_NAME, COU_UNIT) VALUES(7777, 'BOY', 789);


-- 학생
INSERT INTO STUDENT_TBL(STU_NO, STU_NAME, STU_ADDRESS, STU_GRADE, PRO_NO) VALUES(1000, 'A', '서울', 1, 10);
INSERT INTO STUDENT_TBL(STU_NO, STU_NAME, STU_ADDRESS, STU_GRADE, PRO_NO) VALUES(2000, 'B', '대구', 2, 20);
INSERT INTO STUDENT_TBL(STU_NO, STU_NAME, STU_ADDRESS, STU_GRADE, PRO_NO) VALUES(3000, 'C', '부산', 3, 30);

-- 삭제먼저
DROP SEQUENCE EN_NO_SEQ;

--수강신청번호 시퀀스 생성
CREATE SEQUENCE EN_NO_SEQ
    START WITH 101
    ORDER;
--수강신청

INSERT INTO ENROLL_TBL(EN_NO, STU_NO, COU_NO, EN_DATE) VALUES(EN_NO_SEQ.NEXTVAL, 1000, 5555, '23-07-03');
INSERT INTO ENROLL_TBL(EN_NO, STU_NO, COU_NO, EN_DATE) VALUES(EN_NO_SEQ.NEXTVAL, 2000, 6666, '23-07-03');
INSERT INTO ENROLL_TBL(EN_NO, STU_NO, COU_NO, EN_DATE) VALUES(EN_NO_SEQ.NEXTVAL, 3000, 7777, '23-07-03');

-- 삭제먼저
DROP SEQUENCE LEC_NO_SEQ;
-- 강의번호 시퀀스 생성
CREATE SEQUENCE LEC_NO_SEQ
    START WITH 1001
    ORDER;
--강의
INSERT INTO LECTURE_TBL(LEC_NO, PRO_NO, EN_NO, LEC_NAME, CLASSROOM) VALUES(LEC_NO_SEQ.NEXTVAL, 10, 101, '1+1', '가');
INSERT INTO LECTURE_TBL(LEC_NO, PRO_NO, EN_NO, LEC_NAME, CLASSROOM) VALUES(LEC_NO_SEQ.NEXTVAL, 20, 102, 'HELLO', '나');
INSERT INTO LECTURE_TBL(LEC_NO, PRO_NO, EN_NO, LEC_NAME, CLASSROOM) VALUES(LEC_NO_SEQ.NEXTVAL, 30, 103, '안녕', '다');
COMMIT;